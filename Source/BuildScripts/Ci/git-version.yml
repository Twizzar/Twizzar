# update the assembly version and generate some env variables like GitVersion.NuGetVersion
parameters:
  - name: IsInternal
    type: string
    default: '$False'

steps:
  - task: gitversion/setup@0
    displayName: Install GitVersion
    inputs:
      versionSpec: '5.x'

  - task: gitversion/execute@0
    displayName: Versioning of Assemblies
    inputs:
      updateAssemblyInfo: true

  - task: gitversion/execute@0
    displayName: Versioning of Projects
    inputs:
      additionalArguments: '/updateProjectFiles'

  - task: PowerShell@2
    displayName: Adjust VSIX VS 19 Version
    inputs:
      filePath: '$(versioningScript)'
      arguments: '$(GitVersion.AssemblySemVer) -IsInternal ${{ parameters.IsInternal }} -VsVersion 2019'

  - task: PowerShell@2
    displayName: Adjust VSIX VS 22 Version
    inputs:
      filePath: '$(versioningScript)'
      arguments: '$(GitVersion.AssemblySemVer) -IsInternal ${{ parameters.IsInternal }} -VsVersion 2022'